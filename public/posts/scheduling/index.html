<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Local job scheduling | Colin Spear</title>
  <meta name="description" content="Hi! I&#39;m Colin. This is my playground. I share my writing, my notes and my intellectual wanderings here. I hope you can find something of interest amongst the many things that interest me. If you do, I would love to hear from you. You can send me an email at colinspear@gmail.com or find me on Twitter at [@colinspear](https://twitter.com/colinspear). If you would like to know a bit more about me, head over to the about page.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Local job scheduling" />
<meta property="og:description" content="In which Colin learns to schedule a task" />
<meta property="og:type" content="article" />
<meta property="og:url" content="main.d1zllkef03p41t.amplifyapp.com/posts/scheduling/" />
<meta property="article:published_time" content="2020-07-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-21T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Local job scheduling"/>
<meta name="twitter:description" content="In which Colin learns to schedule a task"/>

  
  
    
  
  
  <link rel="stylesheet" href="main.d1zllkef03p41t.amplifyapp.com/css/style-white.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="main.d1zllkef03p41t.amplifyapp.com/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/learning">Learning</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/notes">Notes</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/people/people">People</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/posts">Posts</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/tags">Tags</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" main.d1zllkef03p41t.amplifyapp.com/posts/sklearn-custom-transformer/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="main.d1zllkef03p41t.amplifyapp.com/posts/count-files-by-type-and-directory/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&text=Local%20job%20scheduling" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&title=Local%20job%20scheduling" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&is_video=false&description=Local%20job%20scheduling" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Local%20job%20scheduling&body=Check out this article: main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&title=Local%20job%20scheduling" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&title=Local%20job%20scheduling" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&name=Local%20job%20scheduling&description=In%20which%20Colin%20learns%20to%20schedule%20a%20task" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&t=Local%20job%20scheduling" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#cron">Cron</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Local job scheduling
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-07-21 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-21</time>
          
        </div>
        
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/main.d1zllkef03p41t.amplifyapp.com/tags/command-line" rel="tag">command line</a>
            
             ,  
            <a class="tag-link" href="/main.d1zllkef03p41t.amplifyapp.com/tags/shell" rel="tag">shell</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <p>Learning to schedule a task has been on my list of to-learns for some time. Some time ago, I started collecting data on my Spotify Discover Weekly playlist through <a href="https://developer.spotify.com/documentation/web-api/">Spotify&rsquo;s great API</a>. If you&rsquo;re not familiar, Discover Weekly is a personalize playlist that Spotify refreshes every week. As far as I know there is no way of seeing previous week&rsquo;s playlists, so I decided I would keep a record for myself. I collect most of the song features for the songs in my playlist, of which there are many. For a few months I have just be manually running the script I wrote to collect this data, but as a human, I sometimes forget and as a programmer I want to solve my human fallibility through code wherever possible. Hence, automating the data collection.</p>
<h2 id="cron">Cron</h2>
<p>Chances are you have heard of a cron job. Cron is a small utility that has been around for nearly fifty years and can be used on any Linux or Unix-like (say MacOS) operating system. It can be used to run many different processes, is very simple to set up a job once you get the hang of it and is great for scheduling repetitive tasks&hellip; if you always leave your computer on. We&rsquo;ll get back to that last point.</p>
<p>So, let&rsquo;s set up a job:</p>
<pre><code>crontab -e
</code></pre><p>This will open up your crontab file which will be where all your jobs live. If you haven&rsquo;t scheduled a job in the past, this will likely be empty at this point. Basic job formatting is as follows:</p>
<pre><code> ┌───────────── minute (0 - 59)
 │ ┌───────────── hour (0 - 23)
 │ │ ┌───────────── day of the month (1 - 31)
 │ │ │ ┌───────────── month (1 - 12)
 │ │ │ │ ┌───────────── day of the week (0 - 6) (Sunday to Saturday;
 │ │ │ │ │                                   7 is also Sunday on some systems)
 │ │ │ │ │
 │ │ │ │ │
 * * * * * &lt;command to execute&gt;
</code></pre><p>In my case, I want my bot to post often enough that there is regular new content, but without running out of samples too quickly. For this project I&rsquo;m using a dataset of applications for <a href="https://github.com/veltman/ca-license-plates">California Vanity license plates</a>. I&rsquo;m only interested in rejected plates, so once I drop the others and do a bit more clean up, I&rsquo;m left with <strong>NUMBER</strong> remaining samples. At this rate, if I were to post twice a day, it would take <strong>NUMBER</strong> to run out of samples. That seems sufficiently long, so twice a day it is. Here&rsquo;s the line in my crontab that does just that<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>:</p>
<pre><code>30 9,21 * * * /path/to/program /path/to/script
</code></pre><p>The above command says, &ldquo;run <code>script</code> using <code>program</code> at each 9:30 am (minute 30 of hour 9) and 9:30 pm (minute 30 of hour 21).&rdquo; This demonstrates how you can uses commas to specify more than one instance of the period you are referring to. Other special characters are <code>*/</code> which will run your command at a specific interval (<code>/*5 * * * *</code> will run your command every 5 minutes), <code>-</code> which will run your command at each point between the numbers on either side of the <code>-</code> (<code>* * * * 1-5</code> will run your command once a day, Monday through Friday). Have a look at <a href="https://ostechnix.com/a-beginners-guide-to-cron-jobs/">this link</a> for more shortcuts when scheduling jobs. Also, be sure to save and close your crontab before you start freaking out about your job not running even though every. detail. is perfect.</p>
<p>Annoyingly, crontab sends default system emails after each cron job is executed. To disable this feature, simply add <code>2&gt;&amp;1</code> to the end of the job&rsquo;s line in your crontab. It can also be nice to save a log of anything that goes wrong with your job. It can also help if you need to debug your job because it&rsquo;s not doing what you want. To do this, simply redirect the output of the command to a log file. Making these two changes, the above line in my crontab becomes:</p>
<pre><code>30 9,21 * * * /path/to/program /path/to/script &gt; /path/to/logfile.log 2&gt;&amp;1
</code></pre><p>Now I have a program that runs twice a day, prints any error that comes up to a log file and does not spam me with a bunch of email I don&rsquo;t want. Yeeha. Unfortunately, this really isn&rsquo;t great if you ever turn your computer off.</p>
<ul>
<li>
<p>run at save / close</p>
</li>
<li>
<p>Okay, that was great. Unfortunately, crontab doesn't have a lot of flexibility.</p>
</li>
<li>
<p>List common use cases where it breaks down</p>
</li>
<li>
<p>There are a number of other tools available to fill in the gaps: list</p>
</li>
<li>
<p>Turns out since $YEAR cron uses launchd to run processes anyway</p>
</li>
</ul>
<p>Launchd</p>
<ul>
<li>Good <a href="https://beepb00p.xyz/scheduler.html">overview post</a> on scheduling options (say something about cloud options)</li>
<li>Really a pretty annoying tool</li>
<li>Create plist (xml) file</li>
<li>use launchctl from command line to execute</li>
<li>Some GUI solutions, <a href="launched.zerowidth.com">web app</a> - doesn't seem to be a useful command line tool that will generate a plist file for you. I used the zerowidth web app</li>
<li><a href="launchd.info">launchd.info</a> has everything you need to write your plist files and schedule your jobs</li>
<li>Definitely a bit of a pain, but not complicated once you get the hang</li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>If, like me, you are running a python program and want to use the python version you have in your virtual environment, be sure your <code>/path/to/program</code> points to that python version. For me (I run a Macbook) that path takes the shape <code>/Users/user_name/.virtualenvs/env_name/bin/python</code>. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="main.d1zllkef03p41t.amplifyapp.com/learning">Learning</a></li>
         
          <li><a href="main.d1zllkef03p41t.amplifyapp.com/notes">Notes</a></li>
         
          <li><a href="main.d1zllkef03p41t.amplifyapp.com/people/people">People</a></li>
         
          <li><a href="main.d1zllkef03p41t.amplifyapp.com/posts">Posts</a></li>
         
          <li><a href="main.d1zllkef03p41t.amplifyapp.com/tags">Tags</a></li>
         
          <li><a href="main.d1zllkef03p41t.amplifyapp.com/about">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#cron">Cron</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&text=Local%20job%20scheduling" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&title=Local%20job%20scheduling" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&is_video=false&description=Local%20job%20scheduling" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Local%20job%20scheduling&body=Check out this article: main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&title=Local%20job%20scheduling" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&title=Local%20job%20scheduling" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&name=Local%20job%20scheduling&description=In%20which%20Colin%20learns%20to%20schedule%20a%20task" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=main.d1zllkef03p41t.amplifyapp.com%2fposts%2fscheduling%2f&t=Local%20job%20scheduling" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  Colin Spear 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/learning">Learning</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/notes">Notes</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/people/people">People</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/posts">Posts</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/tags">Tags</a></li>
         
        <li><a href="main.d1zllkef03p41t.amplifyapp.com/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/main.d1zllkef03p41t.amplifyapp.com/lib/font-awesome/css/all.min.css>
<script src=/main.d1zllkef03p41t.amplifyapp.com/lib/jquery/jquery.min.js></script>
<script src=/main.d1zllkef03p41t.amplifyapp.com/js/main.js></script>



</html>
