<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>git status - fatal: cannot chdir | Colin Spear</title>
<meta name=keywords content="command line,shell,git">
<meta name=description content="tldr: If you make any changes to the file path of a git submodule, you need to also update all of your config files accordingly.
Background I use the Papermod Hugo theme for my personal website. One of the ways to use Hugo themes is to install them as a submodule inside your project&rsquo;s ./themes directory. I wanted to update the module today as there have been a number of changes since I set it up.">
<meta name=author content="Me">
<link rel=canonical href=//www.colinspear.com/technical-posts/git-submodule-fatal-cannot-chdir/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css integrity="sha256-7I2jZsovtkdTfMt6j2+ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=//www.colinspear.com/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=//www.colinspear.com/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=//www.colinspear.com/favicon-32x32.png>
<link rel=apple-touch-icon href=//www.colinspear.com/apple-touch-icon.png>
<link rel=mask-icon href=//www.colinspear.com/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.0">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BFJ2WK0V8F"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-BFJ2WK0V8F',{anonymize_ip:!1})}</script>
<meta property="og:title" content="git status - fatal: cannot chdir">
<meta property="og:description" content="tldr: If you make any changes to the file path of a git submodule, you need to also update all of your config files accordingly.
Background I use the Papermod Hugo theme for my personal website. One of the ways to use Hugo themes is to install them as a submodule inside your project&rsquo;s ./themes directory. I wanted to update the module today as there have been a number of changes since I set it up.">
<meta property="og:type" content="article">
<meta property="og:url" content="//www.colinspear.com/technical-posts/git-submodule-fatal-cannot-chdir/"><meta property="article:section" content="technical-posts">
<meta property="article:published_time" content="2022-05-26T00:00:00+00:00">
<meta property="article:modified_time" content="2022-05-26T00:00:00+00:00"><meta property="og:site_name" content="Colin Spear">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="git status - fatal: cannot chdir">
<meta name=twitter:description content="tldr: If you make any changes to the file path of a git submodule, you need to also update all of your config files accordingly.
Background I use the Papermod Hugo theme for my personal website. One of the ways to use Hugo themes is to install them as a submodule inside your project&rsquo;s ./themes directory. I wanted to update the module today as there have been a number of changes since I set it up.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Technical-posts","item":"//www.colinspear.com/technical-posts/"},{"@type":"ListItem","position":3,"name":"git status - fatal: cannot chdir","item":"//www.colinspear.com/technical-posts/git-submodule-fatal-cannot-chdir/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"git status - fatal: cannot chdir","name":"git status - fatal: cannot chdir","description":"tldr: If you make any changes to the file path of a git submodule, you need to also update all of your config files accordingly.\nBackground I use the Papermod Hugo theme for my personal website. One of the ways to use Hugo themes is to install them as a submodule inside your project\u0026rsquo;s ./themes directory. I wanted to update the module today as there have been a number of changes since I set it up.","keywords":["command line","shell","git"],"articleBody":"tldr: If you make any changes to the file path of a git submodule, you need to also update all of your config files accordingly.\nBackground I use the Papermod Hugo theme for my personal website. One of the ways to use Hugo themes is to install them as a submodule inside your project’s ./themes directory. I wanted to update the module today as there have been a number of changes since I set it up.\nNormally, with a submodule, you would just navigate to the directory containing the submodule and run your standard git pull commands to incorporate any changes to the remote. Unfortunately for me, when I got to my Papermod directory and ran git status to see where the repo was, I got a fatal: not a git repository error.\nThankfully, git gives you a bit of a breadcrumb trail to follow in it’s error code: a path. I checked the path and it wasn’t pointing to the right .git/module. After some minutes of head scratching, I realized there was an extra themes/ in the error that git threw. Then I remembered that I had moved my Papermod directory after realizing there was a redundant themes directory in its original location.\nIt turns out I had just copy pasted the Papermod instructions for adding the theme as a submodule without thinking about what directory I was in:\ngit submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod Note that themes/ in the final argument of the command. This assumes you are in your site’s main directory. I was already in the themes directory, so instead of installing the module at ./themes/Papermod, I installed it at ./themes/themes/Papermod.\nFix To fix this, I had to update all of the file references in all of the git config files that allow the main directory to talk to the submodule. That means updating four different config files1 with the changes that were made:\n1. .gitmodules You will find an entry that looks like this:\n[submodule \"themes/themes/PaperMod\"] path = themes/themes/PaperMod url = https://github.com/adityatelange/hugo-PaperMod.git Change the path and submodule lines to reflect your changes. In my case, I just had to delete the redundant themes/. Note that the submodule path (the part in quotes) is relative to your repo’s root directory.\n2. .git/config The entry looks quite similar to .gitmodules:\n[submodule \"themes/themes/PaperMod\"] url = https://github.com/adityatelange/hugo-PaperMod.git active = true Just change the submodule line to match the .gitmodules file.\n3. .git/modules//config SUBMODULE_PATH should correspond to the path entry in .gitmodules. For me, this is .git/modules/themes/Papermod/config. This file will have a [core]` section that looks like this:\n[core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true ignorecase = true precomposeunicode = true worktree = ../../../../../themes/themes/PaperMod The last line (worktree) is the one we are interested in. This needs to point to your submodule’s root directory2.\n4. themes//.git Here you will find a line like this:\ngitdir: ../../../.git/modules/themes/themes/PaperMod Change this to point to the module directory in the root repo’s .git folder. Make sure your ../s take you to the root directory. Since I brought my submodule up a level, I had to remove one ../.\nAnd that’s it! Now when you run git status, you will hopefully see something like the following:\nOn branch master Your branch is up to date with 'origin/master'. nothing to commit, working tree clean Happy versioning!\n  I found these files with grep (the -r and I will search and ignore directories, respectively) ↩︎\n Note that if you are changing the hierarchy and not just the name, you will will have to change the relative directory refferences (i.e. the number of ../ you have) and not just the names. Since I moved my submodule up a directory, I had to remove a set of ../ as well as a themes/. ↩︎\n   ","wordCount":"628","inLanguage":"en","datePublished":"2022-05-26T00:00:00Z","dateModified":"2022-05-26T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"//www.colinspear.com/technical-posts/git-submodule-fatal-cannot-chdir/"},"publisher":{"@type":"Organization","name":"Colin Spear","logo":{"@type":"ImageObject","url":"//www.colinspear.com/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=//www.colinspear.com accesskey=h title="Colin Spear (Alt + H)">Colin Spear</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=//www.colinspear.com/links/ title=Links>
<span>Links</span>
</a>
</li>
<li>
<a href=//www.colinspear.com/thoughts-posts/ title=Notes>
<span>Notes</span>
</a>
</li>
<li>
<a href=//www.colinspear.com/technical-posts/ title=Technical>
<span>Technical</span>
</a>
</li>
<li>
<a href=//www.colinspear.com/books/ title=Books>
<span>Books</span>
</a>
</li>
<li>
<a href=//www.colinspear.com/tags title=Tags>
<span>Tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=//www.colinspear.com>Home</a>&nbsp;»&nbsp;<a href=//www.colinspear.com/technical-posts/>Technical-posts</a></div>
<h1 class=post-title>
git status - fatal: cannot chdir
</h1>
<div class=post-meta><span title="2022-05-26 00:00:00 +0000 UTC">May 26, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me
</div>
</header>
<div class=post-content><p><strong>tldr: If you make any changes to the file path of a git submodule, you need to also update all of your config files accordingly.</strong></p>
<h2 id=background>Background<a hidden class=anchor aria-hidden=true href=#background>#</a></h2>
<p>I use the Papermod Hugo theme for my personal website. One of the ways to use Hugo themes is to install them as a submodule inside your project&rsquo;s <code>./themes</code> directory. I wanted to update the module today as there have been a number of changes since I set it up.</p>
<p>Normally, with a submodule, you would just navigate to the directory containing the submodule and run your standard <code>git pull</code> commands to incorporate any changes to the remote. Unfortunately for me, when I got to my Papermod directory and ran <code>git status</code> to see where the repo was, I got a <code>fatal: not a git repository</code> error.</p>
<p>Thankfully, git gives you a bit of a breadcrumb trail to follow in it&rsquo;s error code: a path. I checked the path and it wasn&rsquo;t pointing to the right <code>.git/module</code>. After some minutes of head scratching, I realized there was an extra <code>themes/</code> in the error that git threw. Then I remembered that I had moved my Papermod directory after realizing there was a redundant <code>themes</code> directory in its original location.</p>
<p>It turns out I had just copy pasted the Papermod instructions for adding the theme as a submodule without thinking about what directory I was in:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>git submodule add --depth<span class=o>=</span><span class=m>1</span> https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
</code></pre></div><p>Note that <code>themes/</code> in the final argument of the command. This assumes you are in your site&rsquo;s main directory. I was already in the themes directory, so instead of installing the module at <code>./themes/Papermod</code>, I installed it at <code>./themes/themes/Papermod</code>.</p>
<h2 id=fix>Fix<a hidden class=anchor aria-hidden=true href=#fix>#</a></h2>
<p>To fix this, I had to update all of the file references in all of the git config files that allow the main directory to talk to the submodule. That means updating four different config files<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> with the changes that were made:</p>
<h3 id=1-gitmodules>1. <code>.gitmodules</code><a hidden class=anchor aria-hidden=true href=#1-gitmodules>#</a></h3>
<p>You will find an entry that looks like this:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>submodule</span> <span class=s2>&#34;themes/themes/PaperMod&#34;</span><span class=p>]</span>
	<span class=nx>path</span> <span class=p>=</span> <span class=nx>themes</span><span class=err>/</span><span class=nx>themes</span><span class=err>/</span><span class=nx>PaperMod</span>
	<span class=nx>url</span> <span class=p>=</span> <span class=nx>https</span><span class=err>://</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=err>/</span><span class=nx>adityatelange</span><span class=err>/</span><span class=nx>hugo-PaperMod</span><span class=p>.</span><span class=nx>git</span>
</code></pre></div><p>Change the <code>path</code> and <code>submodule</code> lines to reflect your changes. In my case, I just had to delete the redundant <code>themes/</code>. Note that the submodule path (the part in quotes) is relative to your repo&rsquo;s root directory.</p>
<h3 id=2-gitconfig>2. <code>.git/config</code><a hidden class=anchor aria-hidden=true href=#2-gitconfig>#</a></h3>
<p>The entry looks quite similar to <code>.gitmodules</code>:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>submodule</span> <span class=s2>&#34;themes/themes/PaperMod&#34;</span><span class=p>]</span>
	<span class=nx>url</span> <span class=p>=</span> <span class=nx>https</span><span class=err>://</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=err>/</span><span class=nx>adityatelange</span><span class=err>/</span><span class=nx>hugo-PaperMod</span><span class=p>.</span><span class=nx>git</span>
	<span class=nx>active</span> <span class=p>=</span> <span class=kc>true</span>
</code></pre></div><p>Just change the <code>submodule</code> line to match the <code>.gitmodules</code> file.</p>
<h3 id=3-gitmodulessubmodule_pathconfig>3. <code>.git/modules/&lt;SUBMODULE_PATH>/config</code><a hidden class=anchor aria-hidden=true href=#3-gitmodulessubmodule_pathconfig>#</a></h3>
<p><code>SUBMODULE_PATH</code> should correspond to the path entry in <code>.gitmodules</code>. For me, this is <code>.git/modules/themes/Papermod/config. This file will have a </code>[core]` section that looks like this:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>core</span><span class=p>]</span>
	<span class=nx>repositoryformatversion</span> <span class=p>=</span> <span class=mi>0</span>
	<span class=nx>filemode</span> <span class=p>=</span> <span class=kc>true</span>
	<span class=nx>bare</span> <span class=p>=</span> <span class=kc>false</span>
	<span class=nx>logallrefupdates</span> <span class=p>=</span> <span class=kc>true</span>
	<span class=nx>ignorecase</span> <span class=p>=</span> <span class=kc>true</span>
	<span class=nx>precomposeunicode</span> <span class=p>=</span> <span class=kc>true</span>
	<span class=nx>worktree</span> <span class=p>=</span> <span class=p>..</span><span class=err>/</span><span class=p>..</span><span class=err>/</span><span class=p>..</span><span class=err>/</span><span class=p>..</span><span class=err>/</span><span class=p>..</span><span class=err>/</span><span class=nx>themes</span><span class=err>/</span><span class=nx>themes</span><span class=err>/</span><span class=nx>PaperMod</span>
</code></pre></div><p>The last line (<code>worktree</code>) is the one we are interested in. This needs to point to your <em>submodule&rsquo;s</em> root directory<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p>
<h3 id=4-themestheme_namegit>4. <code>themes/&lt;THEME_NAME>/.git</code><a hidden class=anchor aria-hidden=true href=#4-themestheme_namegit>#</a></h3>
<p>Here you will find a line like this:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>gitdir: ../../../.git/modules/themes/themes/PaperMod
</code></pre></div><p>Change this to point to the module directory in the root repo&rsquo;s <code>.git</code> folder. Make sure your <code>../</code>s take you to the root directory. Since I brought my submodule up a level, I had to remove one <code>../</code>.</p>
<p>And that&rsquo;s it! Now when you run <code>git status</code>, you will hopefully see something like the following:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>On branch master
Your branch is up to date with &#39;origin/master&#39;.

nothing to commit, working tree clean
</code></pre></div><p>Happy versioning!</p>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>I found these files with grep (the <code>-r</code> and <code>I</code> will search and ignore directories, respectively)&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p>Note that if you are changing the hierarchy and not just the name, you will will have to change the relative directory refferences (i.e. the number of <code>../</code> you have) and not just the names. Since I moved my submodule up a directory, I had to remove a set of <code>../</code> as well as a <code>themes/</code>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=//www.colinspear.com/tags/command-line/>command-line</a></li>
<li><a href=//www.colinspear.com/tags/shell/>shell</a></li>
<li><a href=//www.colinspear.com/tags/git/>git</a></li>
</ul>
<nav class=paginav>
<a class=prev href=//www.colinspear.com/links/2022-03-28/>
<span class=title>« Prev</span>
<br>
<span>2022-05-30</span>
</a>
<a class=next href=//www.colinspear.com/books/english-patient/>
<span class=title>Next »</span>
<br>
<span>The English Patient</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=//www.colinspear.com>Colin Spear</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerHTML='copy';function d(){a.innerHTML='copied!',setTimeout(()=>{a.innerHTML='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>